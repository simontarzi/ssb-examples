{"version":1,"sql":"-- We will consider two transactions with the same \"account_id\" :\n-- Occurring in 2 different locations,\n-- With a distance greater than 1 KM,\n-- And with less than 10 minutes between them.\n\nSELECT\n       txn1.ts as EVENT_TIME,\n       txn2.ts,\n       txn1.account_id as ACCOUNT_ID,\n       txn1.transaction_id AS TRANSACTION_ID,\n       txn2.transaction_id,\n       txn1.amount as AMOUNT,\n       txn1.lat AS LAT,\n       txn1.lon AS LON\n\nFROM  txn1\nINNER JOIN  txn2\non txn1.account_id=txn2.account_id","tables":[{"name":"ssb.ssb_default.txn1","sql":"CREATE TABLE `ssb`.`ssb_default`.`txn1` (\n  `ts` VARCHAR(2147483647),\n  `account_id` BIGINT,\n  `transaction_id` VARCHAR(2147483647),\n  `amount` BIGINT,\n  `lat` DOUBLE,\n  `lon` DOUBLE,\n  `event_time` TIMESTAMP(3) WITH LOCAL TIME ZONE METADATA FROM 'timestamp',\n  WATERMARK FOR `event_time` AS `event_time` - INTERVAL '3' SECOND\n) WITH (\n  'scan.startup.mode' = 'earliest-offset',\n  'properties.request.timeout.ms' = '120000',\n  'properties.auto.offset.reset' = 'earliest',\n  'format' = 'json',\n  'properties.bootstrap.servers' = 'cdp.54.73.61.243.nip.io:9092',\n  'connector' = 'kafka',\n  'properties.transaction.timeout.ms' = '900000',\n  'topic' = 'txn1'\n)\n"},{"name":"ssb.ssb_default.txn2","sql":"CREATE TABLE `ssb`.`ssb_default`.`txn2` (\n  `ts` VARCHAR(2147483647),\n  `account_id` BIGINT,\n  `transaction_id` VARCHAR(2147483647),\n  `amount` BIGINT,\n  `lat` DOUBLE,\n  `lon` DOUBLE,\n  `event_time` TIMESTAMP(3) WITH LOCAL TIME ZONE METADATA FROM 'timestamp',\n  WATERMARK FOR `event_time` AS `event_time` - INTERVAL '3' SECOND\n) WITH (\n  'scan.startup.mode' = 'earliest-offset',\n  'properties.request.timeout.ms' = '120000',\n  'properties.auto.offset.reset' = 'earliest',\n  'format' = 'json',\n  'properties.bootstrap.servers' = 'cdp.54.73.61.243.nip.io:9092',\n  'connector' = 'kafka',\n  'properties.transaction.timeout.ms' = '900000',\n  'topic' = 'txn2'\n)\n"}],"external_catalogs":{},"udfs":[],"js_udfs":[],"jars":[],"mv_data":null}